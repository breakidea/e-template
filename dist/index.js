!function(a,b){var c={version:"1.0.0"},d=function(a,c,d){b===d&&(d=!0),a=a||{};for(var e in c||{})!c.hasOwnProperty(e)||!d&&a.hasOwnProperty(e)||(a[e]=c[e]);return a},e=function(a){return"string"==typeof a&&(a=a.replace(/(^\s*|\s*$)/g,"")),a},f=/<!--\s*([\w\-]{1,}\s*:\s*\{.*?\})\s*-->/m,g=/([\w\-]{1,})\s*:\s*(\{.*?\})/i,h=function(a){var b,c,d,h,i,j=a.split(f),k={};if(j&&j[1])for(d=0,h=j.length;h>d;d++)i=j[d],g.test(i)?(b=RegExp.$1,c=new Function("return "+RegExp.$2)()):b&&(c.content=e(i),c.name=b,k[b]=c,b=c=0);else j[0]&&(k.main={name:"main",content:e(j[0])});return k},i={clean:0,helper:'_.raw=function(a){return a;};_.encode=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\'/g,"&#39;")};',variable:"html",strip:!0,filter:"encode"},j=/<%(.*?)%>\s*/g,k=/(^\s*(var|void|if|for|else|switch|case|break|{|}|;))(.*)?/g,l=/\s*\r?\n\s*/g,m=/\r?\n/g,n=/<!--(?:[\s\S]*?)-->/g,o=function(a,b){var c,e,f=0,g="";for(b=d(b,i,!1),a=b.strip?a.replace(n,""):a,a=b.clean?a.replace(l,""):a,e=function(a,c){a?(c=c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(m,b.clean?"":"\\n"),c&&(g+=b.variable+' += "'+c+'";')):c.match(k)?g+=c:(c=p(c,b.filter))&&(g+=b.variable+" += _."+c+";")};c=j.exec(a);)e(1,a.slice(f,c.index)),e(0,c[1]),f=c.index+c[0].length;return e(1,a.substr(f,a.length-f)),g},p=function(a,b){var c,d,e=/(=|:|-)?([^|]*)\|?([^:]*)([\w\W]*)/,f=e.exec(a);return f&&f[2]?(d="("+f[2]+")",(c=f[3])&&(d="("+f[2]+f[4].replace(/:/g,", ")+")"),c=c||{"=":"raw","-":"escapeJs",":":"encodeURIComponent"}[f[1]]||b,(c||"encode")+d):!1},q=function(a,b){var c,e,f,g={};a=h(a);for(f in a)c=a[f],e=c.content,d(c,b,!1),"string"==typeof e&&(delete c.content,g[f]=r(e,c));return{get:function(a){return a?g[a]||function(){throw"[typeError] section `"+a+"` not found."}:g},render:function(a,c,e){var f=this.get(a);return"function"==typeof f?(e=e||{},b.helper&&"object"==typeof b.helper&&d(e,b.helper,!1),f.call(null,c,e)||""):void 0}}},r=function(a,b){var c,e,f,g,h;if(b=d(b,i,!1),c=o(a,b),e='data = (data && typeof data == "object") ? data : {}; _ = _ || {};',f="return "+b.variable+";",e+="string"==typeof b.helper?b.helper:"/*外部提供*/",b.apply)for(h=0;h<b.apply.length;h++)e+="var "+b.apply[h]+' = data["'+b.apply[h]+'"];';else c="with(data){"+c+"}";return c="var "+b.variable+' = "";'+c,c=e+c+f,g=new Function(["data","_"],c),d(g,{stringify:function(a){var b=g.toString().substr(18);return a&&"string"==typeof a?~a.lastIndexOf(".")?a+" = function "+b+";":"function "+a+" "+b:"function "+b},render:function(a,c){return c=c||{},b.helper&&"object"==typeof b.helper&&d(c,b.helper,!1),g.call(null,a,c)||""}}),g};c.config=i,c.compile=r,c.compileMulti=q,c._parseTpl=h,c._filterVars=p,c._convert=o,"function"==typeof require&&"object"==typeof module&&"object"==typeof module.exports?module.exports=c:"function"==typeof define&&define.amd?define(["exports"],function(){return c}):a.xTemplator=a.xTemplator||c}(this);